

CREATE TABLE MV_GENRE 
(
GENRE_ID INTEGER NOT NULL PRIMARY KEY,
NAME VARCHAR(100) NOT NULL
);

CREATE GENERATOR MV_GENRE_GEN;

CREATE TABLE MV_MOVIE
(
	MOVIE_ID INTEGER NOT NULL PRIMARY KEY,
	TITLE VARCHAR(200) NOT NULL,
	DESCRIPTION VARCHAR(1000),
	STORYLINE BLOB SUB_TYPE TEXT,
	RELEASE_YEAR INTEGER,
	RELEASE_DATE TIMESTAMP,
	RUNTIME INTEGER,
	KIND INTEGER DEFAULT 1 NOT NULL,
	PRIMARY_IMAGE VARCHAR(100),
	GALLERY_IMAGES BLOB SUB_TYPE TEXT
);

CREATE GENERATOR MV_MOVIE_GEN;

CREATE TABLE MV_MOVIE_GENRES
(
	MOVIE_GENRE_ID INTEGER NOT NULL PRIMARY KEY,
	MOVIE_ID INTEGER NOT NULL REFERENCES MV_MOVIE(MOVIE_ID),
	GENRE_ID INTEGER NOT NULL REFERENCES MV_GENRE(GENRE_ID)
);

CREATE GENERATOR MV_MOVIE_GENRES_GEN;

CREATE TABLE MV_PERSON
(
	PERSON_ID INTEGER NOT NULL PRIMARY KEY,
	FIRSTNAME VARCHAR(50) NOT NULL,
	LASTNAME VARCHAR(50) NOT NULL,
	BIRTHDATE TIMESTAMP,
	BIRTHPLACE VARCHAR(100),
	GENDER INTEGER,
	HEIGHT INTEGER,
	PRIMARY_IMAGE VARCHAR(100),
	GALLERY_IMAGES BLOB SUB_TYPE TEXT
);

CREATE GENERATOR MV_PERSON_GEN;

CREATE TABLE MV_MOVIECAST
(
	MOVIECAST_ID INTEGER NOT NULL PRIMARY KEY,
	MOVIE_ID INTEGER NOT NULL REFERENCES MV_MOVIE(MOVIE_ID),
	PERSON_ID INTEGER NOT NULL REFERENCES MV_PERSON(PERSON_ID),
	MOVIE_CHARACTER VARCHAR(50)
);

CREATE GENERATOR MV_MOVIECAST_GEN;

commit work;

SET TERM ^ ;

CREATE TRIGGER MV_MOVIE_TRG FOR MV_MOVIE
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
    IF (NEW.MOVIE_ID IS NULL) THEN
        NEW.MOVIE_ID = GEN_ID(MV_MOVIE_GEN, 1);
END^

CREATE TRIGGER MV_GENRE_TRG FOR MV_GENRE
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
    IF (NEW.GENRE_ID IS NULL) THEN
        NEW.GENRE_ID = GEN_ID(MV_GENRE_GEN, 1);
END^

CREATE TRIGGER MV_MOVIE_GENRES_TRG FOR MV_MOVIE_GENRES
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
    IF (NEW.MOVIE_GENRE_ID IS NULL) THEN
        NEW.MOVIE_GENRE_ID = GEN_ID(MV_MOVIE_GENRES_GEN, 1);
END^

CREATE TRIGGER MV_PERSON_TRG FOR MV_PERSON
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
    IF (NEW.PERSON_ID IS NULL) THEN
        NEW.PERSON_ID = GEN_ID(MV_PERSON_GEN, 1);
END^

CREATE TRIGGER MV_MOVIECAST_TRG FOR MV_MOVIECAST
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
    IF (NEW.MOVIECAST_ID IS NULL) THEN
        NEW.MOVIECAST_ID = GEN_ID(MV_MOVIECAST_GEN, 1);
END^


set term ; ^

COMMIT work;
